import{d as B,Y as I,e as W,k as g,w as D,u as e,P as j,x as G,U as l,_ as c,$ as i,a8 as d,f as a,t as H,A as J,V as h,F as N,a7 as M,W as O,a3 as w}from"./vue-0f3866c3.js";import"./dayjs-4778c158.js";import{aa as Q,T as u,ab as y}from"./index-0f1216c0.js";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang-a055b03e.js";import{i as Z,V as S}from"./jb4-df322d33.js";import{u as ee,a as te}from"./usePlay-95eb2d08.js";import{C as L,R as se,a as oe}from"./Card-b011a411.js";import{D as A}from"./index-b778e87c.js";import{I as le}from"./index-ae87ec0e.js";import{S as ae}from"./index-ee93113e.js";import{a as re}from"./index-80aca252.js";import"./mockjs-890b569b.js";import"./device-1d29c212.js";import"./index-4393de8e.js";import"./useFlexGapSupport-341b3ecd.js";const ne={class:"cursor-pointer fixed top-46% left-0 z-10 flex flex-col bg-black dark:bg-#333 color-#fff p-4px rounded-r-4px"},ce={class:"p-16px pb-0"},ie={class:"mb-8px flex items-center"},ue=d("label",{class:"w-70px text-right"},"分屏总数  ",-1),me={class:"flex items-center"},de=d("label",{class:"w-70px text-right"},"每行屏数  ",-1),pe={key:1,class:"video-player-placeholder"},fe=B({name:"ScreenLarge"}),Be=B({...fe,setup(ve){const r=ee(),{customInfo:s}=I(r),F=W(()=>24/s.value.rowNum),k=()=>{r.setCustomInfo({collapsed:!s.value.collapsed})},V=g({1:"1",2:"2",3:"3",4:"4",6:"6",8:"8",12:"12",24:"24"}),{getActiveInfo:f}=I(r),{updateItem:$,streamList:z,changeStreamList:R,closeAll:P,webrtc:U}=te();D(()=>s.value.screenNum,async()=>{r.setCustomInfo({selectNum:0}),r.setActiveInfo({ID:"",DeviceID:"",DeviceName:"",Name:"",LiveStatus:0});const n=new Array(s.value.screenNum).fill({}).map(()=>({path:""}));R(n)},{immediate:!0}),D(()=>e(f),(n,o)=>{const{ID:t,DeviceID:m}=f.value,_=`${n.ID}/${n.DeviceID}`,x=`${o.ID}/${o.DeviceID}`;n.DeviceID&&_!==x&&Z({id:t,channel:m}).finally(()=>{$(f.value,s.value.selectNum)})});const v=()=>document.querySelector(".screen-custom"),C=g(null),{toggle:T,isFullscreen:p}=Q(C),b=()=>{r.setCustomInfo({collapsed:p}),T()},K=n=>{const{ID:o,DeviceID:t,DeviceName:m,Name:_,LiveStatus:x}=n;r.setActiveInfo({ID:o,DeviceID:t,DeviceName:m,Name:_,LiveStatus:x})},Y=n=>{r.setCustomInfo({selectNum:n})},q=j(),E=()=>{q.go(-1)};return G(()=>{P()}),(n,o)=>(l(),c(e(re),{ref_key:"screenCustom",ref:C,class:"screen-custom h-full w-full flex flex-row"},{default:i(()=>[d("div",ne,[a(e(u),{onClick:E,icon:"entypo:back",class:"v-middle"}),a(e(A),{class:"mx-0 my-4px border-color-#fff"}),e(s).collapsed?(l(),c(e(u),{key:1,onClick:k,icon:"icon-park-solid:expand-left",class:"v-middle"})):(l(),c(e(u),{key:0,onClick:k,icon:"icon-park-solid:expand-right",class:"v-middle"})),a(e(A),{class:"mx-0 my-4px border-color-#fff"}),e(p)?(l(),c(e(u),{key:3,icon:"ant-design:fullscreen-exit-outlined",class:"v-text-bottom",onClick:b})):(l(),c(e(u),{key:2,icon:"ant-design:fullscreen-outlined",class:"v-text-bottom",onClick:b}))]),H(a(e(L),{class:"w-342px m-r-8px h-full",bordered:!1,bodyStyle:{height:"100%",padding:0}},{default:i(()=>[d("div",ce,[d("div",ie,[ue,a(e(le),{value:e(s).screenNum,"onUpdate:value":o[0]||(o[0]=t=>e(s).screenNum=t),min:1,style:{flex:"1"},onChange:o[1]||(o[1]=t=>e(r).setCustomInfo({screenNum:t}))},null,8,["value"])]),d("div",me,[de,a(e(ae),{class:"flex-1",value:e(s).rowNum,"onUpdate:value":o[2]||(o[2]=t=>e(s).rowNum=t),min:1,max:24,step:null,marks:V.value,onChange:o[3]||(o[3]=t=>e(r).setCustomInfo({rowNum:t}))},null,8,["value","step","marks"])])]),a(X,{onSelect:K})]),_:1},512),[[J,!e(s).collapsed]]),a(e(L),{style:{height:"100%",flex:"1"},bordered:!1,bodyStyle:{height:"100%",overflowY:"scroll",padding:"8px"}},{default:i(()=>[a(e(se),{gutter:4,ref:"screenRef"},{default:i(()=>[(l(!0),h(N,null,M(e(z),(t,m)=>(l(),c(e(oe),{span:e(F),key:m,class:O(["mt-4px flex-center",{active:e(s).screenNum>1&&e(s).selectNum===m&&!e(p),isFullscreen:e(p)}]),onClick:()=>Y(m)},{default:i(()=>[t.path?(l(),h(N,{key:0},[e(U)?(l(),c(S,{key:0,webrtcStream:t.stream},{default:i(()=>[t.path?(l(),c(e(y),{key:0,class:"position-absolute bottom-0 left-50% cursor-pointer",title:t.path,getPopupContainer:v},{default:i(()=>[a(e(u),{icon:"octicon:ellipsis-16",size:20,color:"#dedede",hoverColor:"#9dcefc"})]),_:2},1032,["title"])):w("",!0)]),_:2},1032,["webrtcStream"])):(l(),c(S,{key:1,format:"ws-flv","stream-path":t.path},{default:i(()=>[t.path?(l(),c(e(y),{key:0,class:"position-absolute bottom-0 left-50% cursor-pointer",title:t.path,getPopupContainer:v},{default:i(()=>[a(e(u),{icon:"octicon:ellipsis-16",size:20,color:"#dedede",hoverColor:"#9dcefc"})]),_:2},1032,["title"])):w("",!0)]),_:2},1032,["stream-path"]))],64)):(l(),h("div",pe,[a(e(y),{title:"当前无信号，请先选择通道",class:"no-stream-tip cursor-pointer",getPopupContainer:v},{default:i(()=>[a(e(u),{icon:"pepicons-pop:television-play-off",size:30})]),_:1})]))]),_:2},1032,["span","class","onClick"]))),128))]),_:1},512)]),_:1})]),_:1},512))}});export{Be as default};
