import{d as A,Y as I,e as E,k as b,w as D,u as e,P as W,x as G,U as r,_ as i,$ as o,a8 as f,f as s,t as H,A as J,V as y,F as N,a7 as M,W as O,a3 as w}from"./vue-c6b19427.js";import"./dayjs-4778c158.js";import{aa as Q,ab as m,T as d}from"./index-11d05838.js";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang-2cd162d6.js";import{V as S}from"./jb4-7834962a.js";import{u as Z,a as ee}from"./usePlay-fbca14ba.js";import{i as te}from"./gb28281-3366d87d.js";import{C as z,R as se,a as oe}from"./Card-9014be3c.js";import{D as L}from"./index-77704640.js";import{I as le}from"./index-44515305.js";import{S as ae}from"./index-bc9a4f3c.js";import{a as re}from"./index-7109b308.js";import"./mockjs-890b569b.js";import"./device-19839eb7.js";import"./index-48a80b2a.js";import"./useFlexGapSupport-f953e4c0.js";const ne={class:"cursor-pointer fixed top-46% left-0 z-10 flex flex-col bg-black dark:bg-#333 color-#fff p-4px rounded-r-4px"},ce={class:"p-16px pb-0"},ie={class:"mb-8px flex items-center"},ue=f("label",{class:"w-70px text-right"},"分屏总数  ",-1),me={class:"flex items-center"},de=f("label",{class:"w-70px text-right"},"每行屏数  ",-1),pe={key:1,class:"video-player-placeholder"},fe=A({name:"ScreenLarge"}),Be=A({...fe,setup(ve){const n=Z(),{customInfo:l}=I(n),B=E(()=>24/l.value.rowNum),k=()=>{n.setCustomInfo({collapsed:!l.value.collapsed})},F=b({1:"1",2:"2",3:"3",4:"4",6:"6",8:"8",12:"12",24:"24"}),{getActiveInfo:_}=I(n),{updateItem:V,streamList:$,changeStreamList:R,closeAll:P,webrtc:U}=ee();D(()=>l.value.screenNum,async()=>{n.setCustomInfo({selectNum:0}),n.setActiveInfo({ID:"",DeviceID:"",DeviceName:"",Name:"",LiveStatus:0});const c=new Array(l.value.screenNum).fill({}).map(()=>({path:""}));R(c)},{immediate:!0}),D(()=>e(_),(c,a)=>{const{ID:t,DeviceID:p}=_.value,h=`${c.ID}/${c.DeviceID}`,x=`${a.ID}/${a.DeviceID}`;c.DeviceID&&h!==x&&te({id:t,channel:p}).finally(()=>{V(_.value,l.value.selectNum)})});const u=()=>document.querySelector(".screen-custom"),C=b(null),{toggle:T,isFullscreen:v}=Q(C),g=()=>{n.setCustomInfo({collapsed:v}),T()},K=c=>{const{ID:a,DeviceID:t,DeviceName:p,Name:h,LiveStatus:x}=c;n.setActiveInfo({ID:a,DeviceID:t,DeviceName:p,Name:h,LiveStatus:x})},Y=c=>{n.setCustomInfo({selectNum:c})},j=W(),q=()=>{j.go(-1)};return G(()=>{P()}),(c,a)=>(r(),i(e(re),{ref_key:"screenCustom",ref:C,class:"screen-custom h-full w-full flex flex-row"},{default:o(()=>[f("div",ne,[s(e(m),{title:"退出分屏",placement:"right",getPopupContainer:u},{default:o(()=>[s(e(d),{onClick:q,icon:"majesticons:door-exit",class:"v-middle",size:22})]),_:1}),s(e(L),{class:"mx-0 my-4px border-color-#fff"}),e(l).collapsed?(r(),i(e(m),{key:1,title:"展开设备树",placement:"right",getPopupContainer:u},{default:o(()=>[s(e(d),{onClick:k,icon:"icon-park-solid:expand-left",class:"v-middle",size:22})]),_:1})):(r(),i(e(m),{key:0,title:"收起设备树",placement:"right",getPopupContainer:u},{default:o(()=>[s(e(d),{onClick:k,icon:"icon-park-solid:expand-right",class:"v-middle",size:22})]),_:1})),s(e(L),{class:"mx-0 my-4px border-color-#fff"}),e(v)?(r(),i(e(m),{key:3,title:"退出全屏",placement:"right",getPopupContainer:u},{default:o(()=>[s(e(d),{icon:"ant-design:fullscreen-exit-outlined",class:"v-text-bottom",onClick:g,size:22})]),_:1})):(r(),i(e(m),{key:2,title:"全屏",placement:"right",getPopupContainer:u},{default:o(()=>[s(e(d),{icon:"ant-design:fullscreen-outlined",class:"v-text-bottom",onClick:g,size:22})]),_:1}))]),H(s(e(z),{class:"w-342px m-r-8px h-full",bordered:!1,bodyStyle:{height:"100%",padding:0}},{default:o(()=>[f("div",ce,[f("div",ie,[ue,s(e(le),{value:e(l).screenNum,"onUpdate:value":a[0]||(a[0]=t=>e(l).screenNum=t),min:1,style:{flex:"1"},onChange:a[1]||(a[1]=t=>e(n).setCustomInfo({screenNum:t}))},null,8,["value"])]),f("div",me,[de,s(e(ae),{class:"flex-1",value:e(l).rowNum,"onUpdate:value":a[2]||(a[2]=t=>e(l).rowNum=t),min:1,max:24,step:null,marks:F.value,onChange:a[3]||(a[3]=t=>e(n).setCustomInfo({rowNum:t}))},null,8,["value","step","marks"])])]),s(X,{onSelect:K})]),_:1},512),[[J,!e(l).collapsed]]),s(e(z),{style:{height:"100%",flex:"1"},bordered:!1,bodyStyle:{height:"100%",overflowY:"scroll",padding:"8px"}},{default:o(()=>[s(e(se),{gutter:4,ref:"screenRef"},{default:o(()=>[(r(!0),y(N,null,M(e($),(t,p)=>(r(),i(e(oe),{span:e(B),key:p,class:O(["mt-4px flex-center",{active:e(l).screenNum>1&&e(l).selectNum===p&&!e(v),isFullscreen:e(v)}]),onClick:()=>Y(p)},{default:o(()=>[t.path?(r(),y(N,{key:0},[e(U)?(r(),i(S,{key:0,webrtcStream:t.stream},{default:o(()=>[t.path?(r(),i(e(m),{key:0,class:"position-absolute bottom-0 left-50% cursor-pointer",title:t.path,getPopupContainer:u},{default:o(()=>[s(e(d),{icon:"octicon:ellipsis-16",size:20,color:"#dedede",hoverColor:"#9dcefc"})]),_:2},1032,["title"])):w("",!0)]),_:2},1032,["webrtcStream"])):(r(),i(S,{key:1,format:"ws-flv","stream-path":t.path},{default:o(()=>[t.path?(r(),i(e(m),{key:0,class:"position-absolute bottom-0 left-50% cursor-pointer",title:t.path,getPopupContainer:u},{default:o(()=>[s(e(d),{icon:"octicon:ellipsis-16",size:20,color:"#dedede",hoverColor:"#9dcefc"})]),_:2},1032,["title"])):w("",!0)]),_:2},1032,["stream-path"]))],64)):(r(),y("div",pe,[s(e(m),{title:"当前无信号，请先选择通道",class:"no-stream-tip cursor-pointer",getPopupContainer:u},{default:o(()=>[s(e(d),{icon:"pepicons-pop:television-play-off",size:30})]),_:1})]))]),_:2},1032,["span","class","onClick"]))),128))]),_:1},512)]),_:1})]),_:1},512))}});export{Be as default};
